<!DOCTYPE html>
<html>
   <head>
      <title>El Lokal Bilder Gallerie</title>
      <link rel="stylesheet" href="ellokal.css">
      <script type = "text/javascript"
          src = "http://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js">
      </script>
      <script type = "text/javascript" language = "javascript">
      function DoSearchQuery( text) {
         $.getJSON( "http://127.0.0.1/ellokalQuery.php",
         {
             q: text,
             i: 0
         },
         function(jd) {
            if (jd.error)
            {
                alert( "Error: " + jd.error );
            }
            else
            {
                 $('#ranklist').html('');
                 $.each( jd.result, function( i, obj) {
                      $('#ranklist').append('<div id="rank">');
                      $('#ranklist').append('<div id="thumbnail"><img alt="Thumbnail" src="data:image/png;base64,' + obj.thumbnail + '"/></div>');
                      $('#ranklist').append('<div id="prop">');
                      $('#ranklist').append('<ol>');
                      $('#ranklist').append('<li><div id="title">' + obj.title + '</div></li>');
                      $('#ranklist').append('<li><div id="id">' + obj.filename + '</div></li>');
                      $('#ranklist').append('<li><div id="date">' + obj.insertdate + '</div></li>');
                      $('#ranklist').append('<li><div id="dimension">' + obj.width + ' x ' + obj.length + '</div></li>');
                      $('#ranklist').append("</ol>\n");
                      $('#ranklist').append("</div>\n");
                      $('#ranklist').append("</div>\n");
                 });
            }
         })
         .fail(function(jqXHR, status, error){
             alert( "Error (status " + status + "): " + error );
         })
         }

         $(function() {
            $("#search").click(function(jd){
                DoSearchQuery( $('#searchtext').val());
            });
            $("#searchtext").change(function(jd){
                DoSearchQuery( $('#searchtext').val());
            });
            $('#searchtext').bind('input', function() {
                if ($('#searchtext').val().length >= 3) {
                   alert( $('#searchtext').val());
                }
            });
         });

      </script>
   </head>

   <body>
      <div id="content">
      <div id="searchfield">
         <p>Search: <input type = "text" id = "searchtext" /></p>
         <input type = "button" id = "search" value = "Search" />
      </div>
      <div id="searchresult">
         <div id="ranklist"></div>
      </div>
      </div>
   </body>
</html>
